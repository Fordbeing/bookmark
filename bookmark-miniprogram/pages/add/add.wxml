<!--pages/add/add.wxml-->
<view class="page">
  <view class="header">
    <text class="title">{{isEdit ? '编辑书签' : '添加书签'}}</text>
  </view>

  <view class="form">
    <!-- URL -->
    <view class="field">
      <text class="label">网址 <text class="req">*</text></text>
      <input class="input" placeholder="https://..." value="{{form.url}}" bindinput="onUrlInput" />
    </view>

    <!-- 标题 -->
    <view class="field">
      <text class="label">标题 <text class="req">*</text></text>
      <input class="input" placeholder="书签标题" value="{{form.title}}" bindinput="onTitleInput" />
    </view>

    <!-- 分类 + 收藏 一行 -->
    <view class="row">
      <view class="field flex-1">
        <text class="label">分类</text>
        <picker mode="selector" range="{{categoryOptions}}" range-key="name" value="{{selectedCategoryIndex}}" bindchange="onCategoryChange">
          <view class="picker">
            <text>{{selectedCategoryName}}</text>
            <text class="arrow">›</text>
          </view>
        </picker>
      </view>
      <view class="switch-box">
        <text class="label">收藏</text>
        <switch checked="{{form.isFavorite}}" bindchange="onFavoriteChange" color="#6366f1" />
      </view>
    </view>

    <!-- 描述 (缩小) -->
    <view class="field">
      <text class="label">描述</text>
      <textarea class="textarea" placeholder="书签描述（可选）" value="{{form.description}}" bindinput="onDescriptionInput" maxlength="200" />
    </view>

    <!-- 标签 -->
    <view class="field">
      <text class="label">标签</text>
      <view class="tags-box">
        <view class="tag" wx:for="{{form.tags}}" wx:key="*this">
          {{item}} <text class="tag-x" data-index="{{index}}" bindtap="removeTag">×</text>
        </view>
        <input class="tag-input" placeholder="+ 添加标签" value="{{tagInput}}" bindinput="onTagInput" bindconfirm="addTag" />
      </view>
    </view>
  </view>

  <!-- 按钮 -->
  <view class="btns">
    <view class="btn-save" bindtap="handleSubmit">{{loading ? '保存中...' : '保存'}}</view>
    <view class="btn-cancel" bindtap="goBack">取消</view>
    <view class="btn-delete" wx:if="{{isEdit}}" bindtap="handleDelete">删除</view>
  </view>
</view>
